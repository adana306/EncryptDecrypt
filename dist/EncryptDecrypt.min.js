/**
 * 
 * @source: https://github.com/wwwouaiebe/EncryptDecrypt
 * 
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this page.
 * 
 * encryptdecript - version 2.0.0-dev
 * Build 00595 - 2023-03-02T12:36:55+0100 
 * Copyright 2019 2023 wwwouaiebe 
 * Contact: https://www.ouaie.be/
 * License: GPL-3.0
 * 
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 * 
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 * 
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 * 
 */


!function(){"use strict";const e=new class{#e;#t(e){return window.crypto.subtle.importKey("raw",e,{name:"PBKDF2"},!1,["deriveKey"])}#n(e,t){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:(new window.TextEncoder).encode(t),iterations:1e6,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}#i(e,t){return window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(t.slice(0,16))},e,new Uint8Array(t.slice(16)))}#r(e,t,n){return window.crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,n)}constructor(e){this.#e=e||"Tire la chevillette la bobinette cherra. Le Petit Chaperon rouge tira la chevillette.",Object.freeze(this)}encryptData(e,t,n,i){let r=window.crypto.getRandomValues(new Uint8Array(16));i.then((e=>this.#t(e))).then((e=>this.#n(e,this.#e))).then((t=>this.#r(t,r,e))).then((e=>{t(new Blob([r,new Uint8Array(e)],{type:"application/octet-stream"}))})).catch(n)}decryptData(e,t,n,i){i.then((e=>this.#t(e))).then((e=>this.#n(e,this.#e))).then((t=>this.#i(t,e))).then(t).catch(n)}};const t=new class{#o;#s;constructor(){Object.freeze(this),this.#s=document.createElement("div"),this.#s.id="waitAnimation";const e=document.createElement("div");e.id="waitAnimationBullet",this.#s.appendChild(e),this.#o=!0}show(){this.#o&&(document.body.appendChild(this.#s),this.#o=!1)}hide(){this.#o||(document.body.removeChild(this.#s),this.#o=!0)}};class n{#s;#c;#l;#a;#d;#h;#m;static get#p(){return 12}#u(){document.body.removeChild(this.#s)}#E(e,t,n){this.#h=t,this.#m=n,this.#d.innerText="Decrypt"===e?"Type the password used for encryption":"The password must be at least 12 characters long and contain at least \t\t\tone capital, one lowercase, one number, and one other character.",document.body.appendChild(this.#s),this.#a.value="",this.#a.focus()}constructor(){Object.freeze(this),this.#s=document.createElement("div"),this.#s.id="pswMainDiv";const e=document.createElement("div");e.id="pswDiv",this.#s.appendChild(e);const t=document.createElement("label");t.htmlFor="pswInput",t.appendChild(document.createTextNode("Password : ")),e.appendChild(t),this.#a=document.createElement("input"),this.#a.type="password",this.#a.id="pswInput",e.appendChild(this.#a);const n=document.createElement("div");n.id="buttonsDiv",this.#s.appendChild(n),this.#c=document.createElement("input"),this.#c.type="button",this.#c.value="Ok",this.#c.id="okButton",this.#c.addEventListener("click",(()=>this.onOkButtonClick())),n.appendChild(this.#c),this.#l=document.createElement("input"),this.#l.type="button",this.#l.value="Cancel",this.#l.id="cancelButton",this.#l.addEventListener("click",(()=>this.onCancelButtonClick())),n.appendChild(this.#l),this.#d=document.createElement("div"),this.#d.id="errorPswDiv",this.#s.appendChild(this.#d)}onCancelButtonClick(){this.#u(),this.#m(new Error("Canceled by user"))}onOkButtonClick(){let e=this.#a.value;if(n.#p>e.length||!e.match(RegExp("[0-9]+"))||!e.match(RegExp("[a-z]+"))||!e.match(RegExp("[A-Z]+"))||!e.match(RegExp("[^0-9a-zA-Z]")))return this.#a.focus(),void this.#d.classList.add("red");this.#u(),t.show(),this.#h((new window.TextEncoder).encode(e))}getPromise(e){return new Promise(((t,n)=>this.#E(e,t,n)))}}const i=new n;const r=new class{#o;#s;constructor(){Object.freeze(this),this.#s=document.createElement("div"),this.#s.id="errorInterface",this.#o=!0}set errorMsg(e){this.#s.innerText=e,this.#s.classList.add("red")}set infoMsg(e){this.#s.innerText=e,this.#s.classList.remove("red")}show(){this.#o&&(this.#s.innerText="",document.body.appendChild(this.#s),this.#o=!1)}hide(){this.#o||(document.body.removeChild(this.#s),this.#o=!0)}};class o{static get#y(){return 200}#w(e){t.hide();let n=null;try{n=JSON.parse((new TextDecoder).decode(e))}catch(e){return void this.#L(e)}let i=[];for(let e in n.data)i.push(n.data[e]);let r=new Blob([new Uint8Array(i)],{type:n.type}),o=URL.createObjectURL(r),s=document.createElement("a");s.setAttribute("href",o),-1===["application/pdf","text/html","image/jpeg","image/png"].indexOf(n.type)&&s.setAttribute("download",n.name),s.click(),window.URL.revokeObjectURL(o)}#T(e){t.hide();let n=URL.createObjectURL(e),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download","Data"),i.click(),window.URL.revokeObjectURL(n)}#L(e){r.show(),r.errorMsg=e.message}constructor(){Object.freeze(this)}decryptURL(t){fetch(t,{mode:"no-cors"}).then((e=>e.ok&&o.#y===e.status?e.arrayBuffer():Promise.reject(new Error("Invalid url for the encoded file")))).then((t=>{e.decryptData(t,(e=>this.#w(e)),(e=>this.#L(e)),i.getPromise("Decrypt"))})).catch((e=>this.#L(e)))}encryptFile(t){let n=new FileReader;n.onload=()=>{e.encryptData((new window.TextEncoder).encode(JSON.stringify({data:new Uint8Array(n.result),name:t.name,type:t.type})),(e=>this.#T(e)),(e=>this.#L(e)),i.getPromise("Encrypt"))},n.readAsArrayBuffer(t)}decryptFile(t){let n=new FileReader;n.onload=()=>{e.decryptData(n.result,(e=>this.#w(e)),(e=>this.#L(e)),i.getPromise("Decrypt"))},n.readAsArrayBuffer(t)}}const s=new o;const c=new class{#o;#s;#H;#M(e){this.hide(),s.encryptFile(e.target.files[0])}#C(e){this.hide(),s.decryptFile(e.target.files[0])}onGoButtonClick(){this.hide(),s.decryptURL(this.#H.value)}#v(){const e=document.createElement("h3");e.innerText="Encrypt",this.#s.appendChild(e);const t=document.createElement("div");this.#s.appendChild(t);const n=document.createElement("input");n.type="file",n.id="encryptButton",n.addEventListener("change",(e=>this.#M(e))),t.appendChild(n)}#b(){const e=document.createElement("h3");e.innerText="Decrypt",this.#s.appendChild(e);const t=document.createElement("div");this.#s.appendChild(t);const n=document.createElement("input");n.type="file",n.id="decryptButton",n.addEventListener("change",(e=>this.#C(e))),t.appendChild(n),this.#H=document.createElement("input"),this.#H.type="url",this.#H.id="urlDecrypt",this.#H.size="128",this.#H.placeholder="https://",t.appendChild(this.#H);let i=document.createElement("input");i.type="button",i.value="Go",i.id="goButton",i.addEventListener("click",(()=>this.onGoButtonClick())),t.appendChild(i)}constructor(){Object.freeze(this),this.#s=document.createElement("div"),this.#s.id="encryptDecrypt",this.#v(),this.#b(),this.#o=!0}show(){this.#o&&(window.document.body.appendChild(this.#s),this.#o=!1)}hide(){this.#o||(document.body.removeChild(this.#s),this.#o=!0)}};(new class{#g(e){"urlDecrypt"===e.target.id&&"Enter"===e.key&&c.onGoButtonClick(),"pswInput"===e.target.id&&("Escape"===e.key||"Esc"===e.key?i.onCancelButtonClick():"Enter"===e.key&&i.onOkButtonClick())}#k(){return window.isSecureContext?window.crypto&&window.crypto.subtle&&window.crypto.subtle.importKey?window.crypto.subtle.importKey("raw",(new window.TextEncoder).encode("hoho"),{name:"PBKDF2"},!1,["deriveKey"]):Promise.reject(new Error("Cryptographic functions are not installed")):Promise.reject(new Error("You don't use a secure context (https or localhost)"))}#f(){const e=new URL(window.location);let t=e.searchParams.get("fil");if(t&&0!==t.length){try{t=atob(t)}catch(e){return Promise.reject(new Error("The fil parameter is not a valid base64 string"))}if(t.match(/[^\w-%:./]/))return Promise.reject(new Error("invalid char in the url encoded in the fil parameter"));const n=new URL(t,e.protocol+"//"+e.hostname);return e.protocol&&n.protocol&&e.protocol===n.protocol&&e.hostname&&n.hostname&&e.hostname===n.hostname?Promise.resolve(encodeURI(n.href)):Promise.reject(new Error("The distant file is not on the same site than the app or use another protocol (http: <-> https:)"))}return Promise.resolve()}startApp(){document.addEventListener("keydown",(e=>this.#g(e)),!0),this.#k().then((()=>this.#f())).then((e=>{e?s.decryptURL(e):c.show()})).catch((e=>{r.show(),r.errorMsg=e.message}))}constructor(){Object.freeze(this)}}).startApp()}();