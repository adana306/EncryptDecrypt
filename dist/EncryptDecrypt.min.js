/**
 * 
 * @source: https://github.com/wwwouaiebe/EncryptDecrypt
 * 
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this page.
 * 
 * encryptdecript - version 1.4.1
 * Build 00455 - 2022-12-06T20:46:36+0100 
 * Copyright 2019 2022 wwwouaiebe 
 * Contact: https://www.ouaie.be/
 * License: GPL-3.0
 * 
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 * 
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 * 
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 * 
 */


!function(){"use strict";let e=function(){function e(e){return window.crypto.subtle.importKey("raw",e,{name:"PBKDF2"},!1,["deriveKey"])}function t(e){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:(new window.TextEncoder).encode("Tire la chevillette la bobinette cherra. Le Petit Chaperon rouge tira la chevillette."),iterations:1e6,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}return Object.seal({encryptData:function(n,r,o,c){!function(n,r,o,c){let d=window.crypto.getRandomValues(new Uint8Array(16));c.then(e).then(t).then((function(e){return window.crypto.subtle.encrypt({name:"AES-GCM",iv:d},e,n)})).then((function(e){r(new Blob([d,new Uint8Array(e)],{type:"application/octet-stream"}))})).catch(o)}(n,r,o,c)},decryptData:function(n,r,o,c){!function(n,r,o,c){c.then(e).then(t).then((function(e){return window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(n.slice(0,16))},e,new Uint8Array(n.slice(16)))})).then(r).catch(o)}(n,r,o,c)}})}(),t="";function n(){a(document.getElementById("encryptDecrypt"));let e=document.createElement("div");e.id="waitAnimation";let t=document.createElement("div");t.id="waitAnimationBullet",e.appendChild(t),document.getElementById("encryptDecrypt").appendChild(e)}function r(e,r){function o(){document.getElementById("okButton").removeEventListener("click",c),document.getElementById("cancelButton").removeEventListener("click",o),r(new Error("Canceled by user"))}function c(){let t=document.getElementById("pswInput").value;if(12>t.length||!t.match(RegExp("[0-9]+"))||!t.match(RegExp("[a-z]+"))||!t.match(RegExp("[A-Z]+"))||!t.match(RegExp("[^0-9a-zA-Z]")))return document.getElementById("pswInput").focus(),void document.getElementById("errorPswDiv").classList.add("red");document.getElementById("okButton").removeEventListener("click",c),document.getElementById("cancelButton").removeEventListener("click",o),n(),e((new window.TextEncoder).encode(t))}a(document.getElementById("encryptDecrypt"));let d=document.createElement("div");d.id="pswMainDiv",document.getElementById("encryptDecrypt").appendChild(d);let i=document.createElement("div");i.id="pswDiv",d.appendChild(i);let l=document.createElement("label");l.htmlFor="pswInput",l.appendChild(document.createTextNode("Password : ")),i.appendChild(l);let u=document.createElement("input");u.type="password",u.id="pswInput",i.appendChild(u);let p=document.createElement("div");p.id="buttonsDiv",d.appendChild(p);let m=document.createElement("input");m.type="button",m.value="Ok",m.id="okButton",m.addEventListener("click",c),p.appendChild(m);let y=document.createElement("input");y.type="button",y.value="Cancel",y.id="cancelButton",y.addEventListener("click",o),p.appendChild(y);let s=document.createElement("div");s.id="errorPswDiv";let h="Decrypt"===t?"Type the password used for encryption":"The password must be at least 12 characters long and contain at least \t\t\tone capital, one lowercase, one number, and one other character.";s.appendChild(document.createTextNode(h)),d.appendChild(s),u.focus()}function o(e){u(),document.getElementById("errorDiv").appendChild(document.createTextNode("An error occurs..."+e.message)),console.log(e)}function c(e){let t=URL.createObjectURL(e),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download","Data"),n.click(),window.URL.revokeObjectURL(t),u()}function d(e){let t=null;try{t=JSON.parse((new TextDecoder).decode(e))}catch(e){return void o(e)}let n=[];for(let e in t.data)n.push(t.data[e]);let r=new Blob([new Uint8Array(n)],{type:t.type}),c=URL.createObjectURL(r),d=document.createElement("a");d.setAttribute("href",c),-1===["application/pdf","text/html","image/jpeg","image/png"].indexOf(t.type)&&d.setAttribute("download",t.name),d.click(),window.URL.revokeObjectURL(c),u()}function i(n){a(document.getElementById("errorDiv")),t="Encrypt";let d=new FileReader,i=n.target.files[0];d.onload=function(){e.encryptData((new window.TextEncoder).encode(JSON.stringify({data:new Uint8Array(d.result),name:i.name,type:i.type})),c,o,new Promise(r))},d.readAsArrayBuffer(i)}function l(n){a(document.getElementById("errorDiv")),t="Decrypt";let c=new FileReader;c.onload=function(){e.decryptData(c.result,d,o,new Promise(r))},c.readAsArrayBuffer(n.target.files[0])}function a(e){for("encryptDecrypt"===e.id&&(document.getElementById("encryptButton")&&document.getElementById("encryptButton").removeEventListener("change",i),document.getElementById("decryptButton")&&document.getElementById("decryptButton").removeEventListener("change",l),document.getElementById("goButton")&&document.getElementById("goButton").removeEventListener("click",m));e.firstChild;)e.removeChild(e.firstChild)}function u(){a(document.getElementById("encryptDecrypt"));let e=document.createElement("h3");e.appendChild(document.createTextNode("Encrypt"));let t=document.getElementById("encryptDecrypt");t.appendChild(e);let n=document.createElement("div");document.getElementById("encryptDecrypt").appendChild(n);let r=document.createElement("input");r.type="file",r.id="encryptButton",r.addEventListener("change",i),n.appendChild(r);let o=document.createElement("h3");o.appendChild(document.createTextNode("Decrypt")),t.appendChild(o);let c=document.createElement("div");t.appendChild(c);let d=document.createElement("input");d.type="file",d.id="decryptButton",d.addEventListener("change",l),c.appendChild(d);let u=document.createElement("input");u.type="url",u.id="urlDecrypt",u.size="128",u.placeholder="https://",c.appendChild(u);let p=document.createElement("input");p.type="button",p.value="Go",p.id="goButton",p.addEventListener("click",m),c.appendChild(p)}function p(t){if("https"!==t.substr(0,5).toLowerCase())return void o(new Error("the given url don't use the https protocol: "+t));let n=new XMLHttpRequest;n.timeout=15e3,n.onload=function(){if(200===n.status){let t=n.response;t&&e.decryptData(t,d,o,new Promise(r))}else o(new Error("Invalid url"))},n.open("GET",t,!0),n.responseType="arraybuffer",n.send(null)}function m(){a(document.getElementById("errorDiv")),t="Decrypt",p(document.getElementById("urlDecrypt").value)}document.addEventListener("keydown",(function(e){"urlDecrypt"===e.target.id&&"Enter"===e.key&&(t="Decrypt",p(e.target.value)),"pswInput"===e.target.id&&("Escape"===e.key||"Esc"===e.key?document.getElementById("cancelButton").click():"Enter"===e.key&&document.getElementById("okButton").click())}),!0),function(){if(!window.isSecureContext)return Promise.resolve(!1);if(!window.crypto||!window.crypto.subtle||!window.crypto.subtle.importKey)return Promise.resolve(!1);try{return window.crypto.subtle.importKey("raw",(new window.TextEncoder).encode("hoho"),{name:"PBKDF2"},!1,["deriveKey"])}catch(e){return Promise.resolve(!1)}}().then((e=>{if(e){let e=decodeURI(window.location.search).substr(1);"fil="===e.substr(0,4).toLowerCase()?(t="Decrypt",n(),p(decodeURIComponent(atob(e.substr(4))))):u()}else document.getElementById("errorDiv").appendChild(document.createTextNode("Not possible to use encryptDecrypt. The page have unsecure context or\t\t\t\t\tyour browser don't support cryptography functions")),document.getElementById("body").removeChild(document.getElementById("encryptDecrypt"))})).catch((e=>{console.log(e),document.getElementById("errorDiv").appendChild(document.createTextNode("Not possible to use encryptDecrypt. The page have unsecure context or\t\t\t\t\tyour browser don't support cryptography functions")),document.getElementById("body").removeChild(document.getElementById("encryptDecrypt"))}))}();